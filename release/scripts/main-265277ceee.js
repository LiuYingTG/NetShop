window.PUBLIC="http://106.14.183.207:8085";var NetShop=angular.module("NetShop",["ngRoute","ngCookies","infinite-scroll","Controllers","Directives"]);function stopPropagation(o){o.stopPropagation?o.stopPropagation():o.cancelBubble=!0}NetShop.config(["$compileProvider",function(o){o.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|sms):/)}]),NetShop.config(["$routeProvider","$locationProvider",function(o,t){t.hashPrefix(""),o.when("/allPro/:categoryType",{templateUrl:"./templates/allPro.html",controller:"allProController"}).when("/proDetail/:categoryType/:productId",{templateUrl:"./templates/proDetail.html",controller:"proDetailController"}).when("/cartList",{templateUrl:"./templates/cartList.html",controller:"cartListController"}).when("/createOrder",{templateUrl:"./templates/createOrder.html",controller:"createOrderController"}).when("/orderList",{templateUrl:"./templates/orderList.html",controller:"orderListController"}).when("/orderDetail/:orderId",{templateUrl:"./templates/orderDetail.html",controller:"orderDetailController"}).when("/setting",{templateUrl:"./templates/userSetting.html",controller:"userSettingController"}).when("/contactUs",{templateUrl:"./templates/contactUs.html",controller:"contactUsController"}).otherwise({redirectTo:"/allPro/all"})}]),NetShop.config(["$httpProvider",function(o){o.defaults.withCredentials=!0,o.defaults.useXDomain=!0,delete o.defaults.headers.common["X-Requested-With"]}]),NetShop.run(["$rootScope","$cookies","$http","$location",function($rootScope,$cookies,$http,$location){var l;$rootScope.collapsed=!1,$rootScope.showDialogue=!1,$rootScope.showUserLogin=!1,$rootScope.showRegister=!1,$rootScope.setStatus={editAddress:!1,editPwd:!1},$http.get(PUBLIC+"/buyer/category/list").then(function(o){if("success"==o.data.msg){$rootScope.categoryLists=[{categoryName:"全部商品",categoryType:"all"}].concat(o.data.data.slice(1));var t=$rootScope.categoryLists.concat([{categoryName:"我的订单",categoryType:"order"},{categoryName:"用户设置",categoryType:"setting"}]);$rootScope.cateLists=[];for(var e=0;e<t.length;e++)$rootScope.cateLists[t[e].categoryType]=t[e].categoryName;$rootScope.$broadcast("getCateLists",!0)}},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")}),$rootScope.$on("cartUpload",function(event){$rootScope.cartNotEmp=!0,$http.get(PUBLIC+"/buyer/cart/list").then(function(res){$rootScope.cartNum=0;var num=eval(res.data.data.cartItems);num&&($rootScope.cartNum=num.length),$rootScope.cartChaged=!0},function(o){console.log(o)}),$rootScope.cartChaged=!1}),$rootScope.loged=(l=$cookies.get("username"),l?($rootScope.username=l,$rootScope.$broadcast("cartUpload",!0),!0):!($rootScope.username="登录")),$rootScope.categoryType="all",$rootScope.toggle=function(){$rootScope.collapsed=!$rootScope.collapsed;var o=document.querySelectorAll(".navs dd");if($rootScope.collapsed)for(var t=0;t<o.length;t++)o[t].style.transform="translate(0)",o[t].style.transitionDelay="0.1s",o[t].style.transitionDuration=.05*(t+1)+"s";else for(var e=o.length-1,r=e;0<r;r--)o[r].style.transform="translate(-100%)",o[r].style.transitionDelay="",o[r].style.transitionDuration=.05*(e-r)+"s"},$rootScope.toggleDialog=function(){$rootScope.showDialogue=!$rootScope.showDialogue,$rootScope.showDialogue?($rootScope.username="",$rootScope.showUserLogin=!0):($rootScope.showUserLogin=!1,$rootScope.showRegister=!1,$rootScope.collapsed&&$rootScope.toggle())},$rootScope.toCartList=function(){$rootScope.loged?$location.path("/cartList"):window.wxc.xcConfirm("需要登录哦，亲~","info",{onOk:function(){$rootScope.$apply(function(){$rootScope.toggleDialog()})}})},$rootScope.closeNav=function(o){o&&$rootScope.toggle()},$rootScope.$on("$locationChangeSuccess",function(o,t,e){e!=t&&-1==t.split("?")[0].split("#")[1].indexOf("createOrder")&&window.location.reload()}),$rootScope.loged&&$http.get(PUBLIC+"/buyer/order/listStatus").then(function(o){"success"==o.data.msg&&($rootScope.listStatus=o.data.data)},function(o){console.log("网络异常，稍后再试")})}]),NetShop.config(["$httpProvider",function(o){o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",o.defaults.transformRequest=function(o){var t=[];for(var e in o)t.push(e+"="+o[e]);return t.join("&")}}]),angular.module("Controllers",[]).controller("NavController",["$scope","$location","$rootScope","$http","$routeParams","$cookies","$interval",function(o,t,e,r,c,n,i){o.login=function(){0==e.loged&&(e.showUserLogin=!0,e.toggleDialog())},o.byCategory=function(o){"order"==(e.categoryType=o)?e.loged?(e.collapsed&&e.toggle(),t.path("/orderList")):window.wxc.xcConfirm("需要登录哦，亲~","info",{onOk:function(){e.$apply(function(){e.toggleDialog()})}}):"setting"==o?e.loged?(e.collapsed&&e.toggle(),t.path("/setting")):window.wxc.xcConfirm("需要登录哦，亲~","info",{onOk:function(){e.$apply(function(){e.toggleDialog()})}}):"contactUs"==o?(e.toggle(),t.path("/contactUs/")):(e.toggle(),t.path("/allPro/"+o))}}]).controller("allProController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(t,o,e,r,c,n){e.categoryType=c.categoryType,"all"==e.categoryType&&(e.title="全部商品"),e.$on("getCateLists",function(){e.cateLists&&(e.title=e.cateLists[e.categoryType])}),e.cartBtn=!1,e.categoryType=c.categoryType,t.vm={},t.vm.page=1,t.isLast=!1,t.nextLoading=!1,t.allProLists=[],t.vm.nextPage=function(){t.vm.busy||(t.vm.busy=!0,t.nextLoading=!0,"all"==c.categoryType&&(c.categoryType=""),o.get(PUBLIC+"/buyer/product/list",{params:{categoryType:c.categoryType,page:t.vm.page}}).then(function(o){"success"==o.data.msg&&(e.loaded=!0,t.nextLoading=!1,t.allProLists=t.allProLists.concat(o.data.data.content),o.data.data.last?(t.isLast=!0,t.vm.busy=!0):(t.vm.page++,t.vm.busy=!1))},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")}))},t.proDetail=function(o){e.collapsed||r.path("/proDetail/"+e.categoryType+"/"+o)}}]).controller("proDetailController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(t,o,e,r,c,n){e.title="商品详情",e.categoryType=c.categoryType,console.log(e.categoryType);var i=c.productId;t.showed=!1,t.num=1,t.numDown=!0,o.get(PUBLIC+"/buyer/product/detail",{params:{productId:i}}).then(function(o){"success"==o.data.msg&&(e.loaded=!0,t.product=o.data.data,t.product.colorChoosed=0,t.product.sizeChoosed=0,t.productColor=t.product.productColor[0]||"",t.productSize=t.product.productSize[0]||"",t.product.proDetailImg=t.product.productDetailImg.split("|"),t.product.productColor=t.product.productColor.split("_"),t.color='"'+t.product.productColor[0]+'"',t.product.productSize?(t.product.productSize=t.product.productSize.split("_"),t.size='"'+t.product.productSize[0]+'"'):(t.product.productSize=[],t.size=""))},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")}),t.chooseColor=function(o){t.product.colorChoosed=o,t.productColor=t.product.productColor[o],t.color='"'+t.product.productColor[o]+'"'},t.chooseSize=function(o){t.product.sizeChoosed=o,t.productSize=t.product.productSize[o],t.size='"'+t.product.productSize[o]+'"'},t.changeNum=function(o){"+"==o?t.product.productStock<t.num+1?window.wxc.xcConfirm("数量超出范围~","info",{onOk:function(){}}):t.num++:o?t.num--:(t.product.productStock<t.num&&window.wxc.xcConfirm("数量超出范围~","info",{onOk:function(){t.$apply(function(){t.num=1})}}),t.num<1&&window.wxc.xcConfirm("不能再少啦，亲~","info",{onOk:function(){$apply(function(){t.num=1})}})),t.numDown=t.num<=1},t.toggleDia=function(o){t.showed=!t.showed,o&&(t.type=o)},t.$watch("showed",function(o){o?$(".view").css("overflow-y","hidden"):$(".view").css("overflow-y","scroll")}),t.confirmOrder=function(){e.loged?t.product.productStock<t.num?window.wxc.xcConfirm("数量超出范围~","info",{onOk:function(){e.$apply(function(){t.num=1})}}):1==t.type?o.post(PUBLIC+"/buyer/cart/add",{productId:t.product.productId,productColor:t.productColor,productSize:t.productSize,productQuantity:t.num}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("添加购物车成功！","info",{onOk:function(){e.$apply(function(){t.showed=!1,e.$broadcast("cartUpload",!0)})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")}):2==t.type&&r.path("/createOrder").search({params:[{productColor:t.productColor,productId:t.product.productId,img:t.product.productImgMd,name:t.product.productName,productQuantity:t.num,productSize:t.productSize,productPrice:t.product.productPrice}],total:t.num*t.product.productPrice}):window.wxc.xcConfirm("需要登录哦，亲~","info",{onOk:function(){e.$apply(function(){e.toggleDialog()})}})}}]).controller("loginController",["$scope","$http","$rootScope","$location","$cookies",function(t,e,r,o,c){t.userLog={},t.forgetDialog=!1,t.userEmail="",t.userLogin=function(o){o&&window.wxc.xcConfirm("输入信息有误哦，亲~","info",{onOk:function(){}}),e.post(PUBLIC+"/buyer/login",t.userLog).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("登录成功！","info",{onOk:function(){r.$apply(function(){r.toggleDialog(),r.loged=!0,r.userName=t.userLog.username,r.toggle();var o=new Date;o.setHours(o.getHours()+1),c.put("username",t.userLog.username,{expires:o}),t.userLog={},window.location.reload()})}})},function(o){window.wxc.xcConfirm("用户名或密码错误~","info")})},t.sendEmail=function(o){o?window.wxc.xcConfirm("输入信息有误哦，亲~","info"):e.get(PUBLIC+"/buyer/getBackPwd",{params:{email:this.userEmail}}).then(function(o){console.log(o.data),"success"==o.data.msg&&window.wxc.xcConfirm("系统正在校验您的个人信息，稍后将发送密码至您的邮箱，请耐心等待哦，亲~","info",{onOk:function(){t.$apply(function(){t.forgetDialog=!1})}})},function(o){window.wxc.xcConfirm("邮箱未注册哦，亲~","info")})},t.$watch("forgetDialog",function(){console.log(t.forgetDialog)}),t.register=function(){r.showUserLogin=!1,r.showRegister=!0}}]).controller("registerController",["$scope","$http","$rootScope",function(e,r,c){e.userRegister=function(o){var t={username:this.newName,password:this.newPwd,phone:this.phone,email:this.email};o?window.wxc.xcConfirm("输入信息有误哦，亲~","info"):r({method:"post",url:PUBLIC+"/buyer/save",data:t}).then(function(o){window.wxc.xcConfirm("注册成功,快去登录吧~","info",{onOk:function(){c.$apply(function(){e.registerInfo={},c.showRegister=!1,c.showUserLogin=!0})}})},function(o){console.log(o)})}}]).controller("createOrderController",["$scope","$http","$rootScope","$location","$routeParams",function(t,e,r,c,o){r.title="创建订单",r.loaded=!0,r.unchooseAddr=!0,t.products=o.params,t.total=o.total,t.orderRemark="",r.editAddrPage="createOrder",t.products[0].productId||(t.products=[],history.go("-1"));var n="",i=[];t.chooseAddr=function(){r.setStatus.editAddress=!0},t.createOrder=function(){for(var o=0;o<t.products.length;o++)i.push({itemId:t.products[o].itemId||"",productColor:t.products[o].productColor,productId:t.products[o].productId,productQuantity:t.products[o].productQuantity,productSize:t.products[o].productSize});n=JSON.stringify(i),e.post(PUBLIC+"/buyer/order/create",{buyerName:r.createOrderBuyer.buyerName,buyerPhone:r.createOrderBuyer.buyerPhone,buyerAddress:r.createOrderBuyer.buyerAddress,items:n,orderRemark:t.orderRemark}).then(function(o){"success"==o.data.msg?window.wxc.xcConfirm("下单成功,请尽快付款哦！","info",{onOk:function(){r.$apply(function(){i=[],r.$broadcast("cartUpload",!0),c.path("/orderDetail/"+o.data.data.orderId)})}}):window.wxc.xcConfirm(o.data.data.msg,"info")},function(o){console.log(o)})}}]).controller("cartListController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function($scope,$http,$rootScope,$location,$routeParams,$cookies){$rootScope.title="我的购物车",$scope.cartLists=[],$scope.items=[],$scope.checkAll=!1,$scope.checkNum=0,$http.get(PUBLIC+"/buyer/cart/list").then(function(res){if("success"==res.data.msg){if($rootScope.loaded=!0,res.data.data.cartItems){var lists=eval(res.data.data.cartItems);lists.map(function(o,t){$scope.cartLists.push(Object.assign({},o,{checked:!1}))})}}else window.wxc.xcConfirm("需要登录哦，亲~","info",{onOk:function(){$rootScope.$apply(function(){$rootScope.toggleDialog()})}})},function(o){console.log("登录"+o)}),$scope.toProDetail=function(o){$rootScope.collapsed||$location.path("/proDetail/all/"+$scope.cartLists[o].productId)},$scope.proNumChange=function(o,t){if("rv"==o){if($scope.cartLists[t].productQuantity<=1)return;$http.get(PUBLIC+"/buyer/cart/decrease",{params:{itemId:$scope.cartLists[t].itemId}}).then(function(o){"success"==o.data.msg&&$scope.cartLists[t].productQuantity--},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})}else $http.get(PUBLIC+"/buyer/cart/increase",{params:{itemId:$scope.cartLists[t].itemId}}).then(function(o){"success"==o.data.msg&&$scope.cartLists[t].productQuantity++},function(o){window.wxc.xcConfirm("数量超出范围~","info"),$scope.cartLists[t].productQuantity=1})},$scope.editQuantity=function(o,t,e){t<1&&window.wxc.xcConfirm("不能再少啦，亲~","info",{onOk:function(){$scope.$apply(function(){$scope.cartLists[e].productQuantity=1})}}),$http.get(PUBLIC+"/buyer/cart/editQuantity",{params:{itemId:$scope.cartLists[e].itemId,quantity:t}}).then(function(o){},function(o){window.wxc.xcConfirm("数量超出范围~","info"),$scope.cartLists[e].productQuantity=1})},$scope.delete=function(e){window.wxc.xcConfirm("确定删除该商品吗？","confirm",{onOk:function(){$rootScope.$apply(function(){$http.get(PUBLIC+"/buyer/cart/delete",{params:{itemId:$scope.cartLists[e].itemId}}).then(function(o){if("success"==o.data.msg){var t=$scope.cartLists;$scope.cartLists=t.slice(0,e).concat(t.slice(e+1)),$rootScope.cartNum--}},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},$scope.checkAllPros=function(){if(!$rootScope.collapsed){$scope.checkAll=!$scope.checkAll;for(var o=0;o<$scope.cartLists.length;o++)$scope.cartLists[o].checked=$scope.checkAll}},$scope.batchDelete=function(){0==$scope.checkNum?window.wxc.xcConfirm("至少要选择一件商品哦，亲~","info"):window.wxc.xcConfirm("确定删除"+$scope.items.length+"件商品吗，亲？","confirm",{onOk:function(){$rootScope.$apply(function(){var o=$scope.items.join("_");$http.get(PUBLIC+"/buyer/cart/batchDelete",{params:{itemIds:o}}).then(function(o){"success"==o.data.msg&&window.location.reload()},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},$scope.$watch("cartLists",function(){$scope.cartTotal=0,$scope.items=[],$scope.itemsDetail=[];for(var o=$scope.checkNum=0;o<$scope.cartLists.length;o++)if($scope.cartLists[o].checked){var t=1e3*parseFloat($scope.cartLists[o].productPrice*$scope.cartLists[o].productQuantity);$scope.cartTotal=(t+1e3*$scope.cartTotal)/1e3,$scope.checkNum++,$scope.items.push($scope.cartLists[o].itemId),$scope.itemsDetail.push({itemId:$scope.cartLists[o].itemId,productColor:$scope.cartLists[o].productColor,productId:$scope.cartLists[o].productId,img:$scope.cartLists[o].productImgMd,name:$scope.cartLists[o].productName,productQuantity:$scope.cartLists[o].productQuantity,productSize:$scope.cartLists[o].productSize,productPrice:$scope.cartLists[o].productPrice})}0!=$scope.checkNum&&(console.log($scope.checkNum+"-----"+$scope.cartLists.length),$scope.checkNum==$scope.cartLists.length?$scope.checkAll=!0:$scope.checkAll=!1)},!0),$scope.createOrder=function(){console.log("结算"),$scope.itemsDetail.length?$location.path("/createOrder").search({params:$scope.itemsDetail,total:$scope.cartTotal}):window.wxc.xcConfirm("至少要选择一件商品哦，亲~","info")}}]).controller("orderListController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(e,o,r,t,c,n){r.title="我的订单",r.categoryType="order",e.vm={},e.vm.page=1,e.isLast=!1,e.orderLists=[],e.nextloaded=!1,e.vm.nextPage=function(){e.vm.busy||(e.vm.busy=!0,o.get(PUBLIC+"/buyer/order/list",{params:{page:e.vm.page}}).then(function(o){e.nextloaded=!0,"success"==o.data.msg?(r.loaded=!0,e.orderLists=e.orderLists.concat(o.data.data.content),o.data.data.last?(e.isLast=!0,e.vm.busy=!0):(e.vm.page++,e.vm.busy=!1)):console.log("获取商品信息失败，稍后再试")},function(o){console.log("获取商品信息失败，稍后再试err")}))},e.delOrder=function(t){window.wxc.xcConfirm("该订单信息将被删除，不再显示在订单页，是否继续？","confirm",{onOk:function(){r.$apply(function(){o.get(PUBLIC+"/buyer/order/delete",{params:{orderId:e.orderLists[t].orderId}}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("删除成功！","info",{onOk:function(){e.$apply(function(){e.orderLists=e.orderLists.slice(0,t).concat(e.orderLists.slice(t+1))})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},e.cancelOrder=function(t){window.wxc.xcConfirm("取消该订单吗，亲?","confirm",{onOk:function(){r.$apply(function(){o.get(PUBLIC+"/buyer/order/cancel",{params:{orderId:e.orderLists[t].orderId}}).then(function(o){"success"==o.data.msg?window.wxc.xcConfirm("取消成功！","info",{onOk:function(){e.$apply(function(){e.orderLists[t].orderStatus="1"})}}):window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")},function(o){})})},onCancel:function(){}})},e.receiveOrder=function(t){window.wxc.xcConfirm("确认收货后，默认交易完成，是否继续？","confirm",{onOk:function(){r.$apply(function(){o.get(PUBLIC+"/buyer/order/receive",{params:{orderId:e.orderLists[t].orderId}}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("确认成功！","info",{onOk:function(){e.$apply(function(){e.orderLists[t].orderStatus="5"})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},e.orderDetail=function(o){r.collapsed||t.path("/orderDetail/"+e.orderLists[o].orderId)}}]).controller("orderDetailController",["$scope","$http","$rootScope","$location","$routeParams","$cookies","$q",function($scope,$http,$rootScope,$location,$routeParams,$cookies,$q){$rootScope.title="订单详情",$rootScope.categoryType="order",$scope.hasDetail=!1,$scope.hasExpress=!1,$scope.showExDetail=!1,$http.get(PUBLIC+"/buyer/order/detail",{params:{orderId:$routeParams.orderId}}).then(function(res){"success"==res.data.msg?($scope.orderDetail=res.data.data,$rootScope.loaded=!0,4!=$scope.orderDetail.orderStatus&&5!=$scope.orderDetail.orderStatus||$http.get(PUBLIC+"/express/findOne",{params:{orderId:$routeParams.orderId}}).then(function(res){"success"==res.data.msg&&($scope.orderExpress=res.data.data,$scope.hasExpress=!0,$scope.orderExpress.logisticsDetail&&($scope.hasDetail=!0,$scope.logisticsDetail=eval("("+$scope.orderExpress.logisticsDetail+")").data,console.log($scope.logisticsDetail)))},function(o){console.log(o.data)})):window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")},function(o){console.log("orderDetail"+o)}),$scope.showExpressDetail=function(){this.hasDetail&&(this.showExDetail=!0)},$scope.receiveOrder=function(o){window.wxc.xcConfirm("确认收货后，默认交易完成，是否继续？","confirm",{onOk:function(){$rootScope.$apply(function(){$http.get(PUBLIC+"/buyer/order/receive",{params:{orderId:o}}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("确认成功！","info",{onOk:function(){$scope.$apply(function(){$scope.orderDetail.orderStatus="5"})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},$scope.delOrder=function(o){window.wxc.xcConfirm("该订单信息将被删除，不再显示在订单页，是否继续？","confirm",{onOk:function(){$rootScope.$apply(function(){$http.get(PUBLIC+"/buyer/order/delete",{params:{orderId:o}}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("删除成功!","info",{onOk:function(){$scope.$apply(function(){$location.path("/orderList")})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},$scope.cancelOrder=function(o){window.wxc.xcConfirm("取消该订单吗，亲?","confirm",{onOk:function(){$rootScope.$apply(function(){$http.get(PUBLIC+"/buyer/order/cancel",{params:{orderId:o}}).then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("取消成功！","info",{onOk:function(){$scope.$apply(function(){$scope.orderDetail.orderStatus="1"})}})},function(o){console.log("取消成功"+o)})})},onCancel:function(){}})},$scope.toProDetail=function(o){$rootScope.collapsed||$location.path("/proDetail/all/"+$scope.orderDetail.orderDetailList[o].productId)}}]).controller("userSettingController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(o,t,e,r,c,n){e.title="用户设置",e.categoryType="setting";e.loaded=!0,e.editAddrPage="userSetting";o.userLogout=function(){e.collapsed||window.wxc.xcConfirm("确定要退出吗，亲？","confirm",{onOk:function(){e.$apply(function(){t.get(PUBLIC+"/buyer/logout").then(function(o){"success"==o.data.msg&&window.wxc.xcConfirm("退出成功，期待下次光顾！","info",{onOk:function(){e.$apply(function(){e.loged=!1,e.cartNotEmp=!1,n.remove("username"),e.categoryType="all",r.path("/allPro/all")})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})})},onCancel:function(){}})},o.confirmEditPwd=function(o){e.collapsed||(o?window.wxc.xcConfirm("输入信息有误哦，亲~","info"):t.post(PUBLIC+"/buyer/editPwd",{newPassword:this.newPwd}).then(function(o){window.wxc.xcConfirm("修改成功,请重新登录~","info",{onOk:function(){e.$apply(function(){e.loged=!1,e.toggle(),e.cartNotEmp=!1,n.remove("username"),e.categoryType="all",r.path("/allPro/all")})}})},function(o){window.wxc.xcConfirm("修改失败，稍后再试哦亲~","info")}))},o.editAddrShow=function(){e.collapsed||(e.setStatus.editAddress=!0)}}]).controller("contactUsController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(o,t,e,r,c,n){e.title="联系我们",e.categoryType="contacuUs",e.loaded=!0}]).controller("editAddrController",["$scope","$http","$rootScope","$location","$routeParams","$cookies",function(e,r,c,o,t,n){e.buyerAddressId="",e.addrChange=!0,r.get(PUBLIC+"/buyer/address/list").then(function(o){e.addressLists=o.data.data},function(o){console.log(o)}),e.newAddress=function(o){c.collapsed||("new"!=o?(this.$parent.editType="修改",this.$parent.editAddrDetail=!0,this.$parent.buyerAddressId=this.addressList.buyerAddressId,this.$parent.addrUserName=this.addressList.buyerName,this.$parent.addrPhone=this.addressList.buyerPhone,this.$parent.addrText=this.addressList.buyerAddress):(this.editType="新增",this.editAddrDetail=!0,this.buyerAddressId="",this.addrUserName="",this.addrPhone="",this.addrText=""))},e.saveAddress=function(o){if(o)window.wxc.xcConfirm("输入信息有误哦，亲~","info");else{var t={buyerAddressId:this.buyerAddressId,buyerName:this.addrUserName,buyerPhone:this.addrPhone,buyerAddress:this.addrText};r.post(PUBLIC+"/buyer/address/save",t).then(function(o){window.wxc.xcConfirm("保存成功！","info",{onOk:function(){e.$apply(function(){e.addrChange=!0,e.editAddrDetail=!1,c.$broadcast("getOrderBuyer",!0)})}})},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","info")})}},e.chooseThis=function(){"createOrder"==c.editAddrPage&&(c.createOrderBuyer={buyerName:this.addressList.buyerName,buyerPhone:this.addressList.buyerPhone,buyerAddress:this.addressList.buyerAddress},e.editAddrDetail=!1,c.setStatus.editAddress=!1)},e.deleteThis=function(){var o=this.buyerAddressId;console.log(this.buyerAddressId),window.wxc.xcConfirm("确定要删除本地址吗，亲?","confirm",{onOk:function(){e.$apply(function(){r.get(PUBLIC+"/buyer/address/delete",{params:{buyerAddressId:o}}).then(function(o){e.addrChange=!0,e.editAddrDetail=!1,c.$broadcast("getOrderBuyer",!0)},function(o){window.wxc.xcConfirm("出错了，稍后再试哦亲~","confirm")})})},onCancel:function(){}})},c.$on("getOrderBuyer",function(){c.unchooseAddr=!1,r.get(PUBLIC+"/buyer/address/list").then(function(o){e.addressLists=o.data.data},function(o){console.log(o)})})}]),angular.module("Directives",[]).directive("loading",function(){return{restrict:"A",replace:!0,template:'<img src="" alt="" />'}}).directive("ngCheck",function(){var c="ng-checked";return{restrict:"A",require:"ngModel",link:function(t,e,o,r){r.$checked=!0,e.bind("focus",function(o){e.addClass(c),t.$apply(function(){r.$checked=!0})}).bind("blur",function(o){e.removeClass(c),t.$apply(function(){r.$checked=!1})})}}}).directive("ensureUnique",["$http",function(c){return{require:"ngModel",link:function(t,o,e,r){o.bind("focus",function(){r.$setValidity("unique",!0)}).bind("blur",function(){console.log(t[e.ngModel]);var o=PUBLIC+"/buyer/"+e.ensureUnique+"?"+e.name+"="+t[e.ngModel];null!=t[e.ngModel]&&c.get(o).then(function(o){"success"==o.data.msg?r.$setValidity("unique",!0):r.$setValidity("unique",!1)},function(o){r.$setValidity("unique",!1),console.log("网络出错啦，稍后再试哦")})})}}}]).directive("ensureSame",[function(){return{require:"ngModel",link:function(o,t,e,r){t.bind("focus",function(){r.$setValidity("same",!0)}).bind("blur",function(){o.newPwd==o.repwd?r.$setValidity("same",!0):r.$setValidity("same",!1)})}}}]).directive("orderStatus",function(){return{restrict:"A",template:"<span>{{status}}</span>",replace:!0,controller:["$scope","$element","$attrs","$rootScope",function(t,o,e,r){t.$watch(e.orderStatus,function(o){r.listStatus&&(t.status=r.listStatus[o])})}]}}).directive("logisticsInfo",function(){return{restrict:"A",template:'<p style="white-space: pre-wrap;">{{logInfo}}</p>',link:function(t,o,e){t.$watch(e.logisticsInfo,function(o){switch(o){case"0":return void(t.logInfo="下单成功,请尽快付款哦");case"1":return void(t.logInfo="订单已取消");case"2":return void(t.logInfo="卖家处理中，等待发货");case"3":return void(t.logInfo="退款中，请耐心等待");case"4":return void(t.logInfo="包裹已寄出，请耐心等待");case"5":return void(t.logInfo="订单已结束，欢迎下次光临！")}})}}}).directive("navCollapse",function(){return{restrict:"A",scope:!1,link:function(o,t,e){o.$watch(e.navCollapse,function(o){o?$(".view").css("overflow-y","hidden"):$(".view").css("overflow-y","scroll")})}}}).directive("handleDescription",function(){return{restrict:"A",template:'<p style="white-space: pre-wrap;">{{productDescription}}</p>',replace:!0,link:function(t,o,e){t.$watch(e.handleDescription,function(o){if(o){o.split("\n").join("&#10;");t.productDescription=o}})}}}),$(function(){document.documentElement.style.fontSize=window.innerWidth/20+"px",$(".body").css("height","27.375rem")});